<ion-view view-title="My Tasks" hide-back-button="true">

  <ion-content class="padding-top">
    <!--<div class="list">-->
    <div class="button-bar" ng-show="true">
      <a class="button" ng-class="{ 'active': activeButton === 'showTaskListView' }" ng-click="showTaskList();activeButton = 'showTaskListView'"><i class="ion-ios-star"> Current</i></a>
      <a class="button" ng-class="{ 'active': activeButton === 'showCompletedTasksView' }" ng-click="showComplete();activeButton = 'showCompletedView'"><i class="ion-android-checkbox-outline"> Completed</i></a> <!-- button-energized" ng-click="showSimilar()" -->
    </div>

    <div class="showTaskListView_content" ng-show="showTaskListView">
      <div class="item item-tasks item-icon-right"  ng-repeat="(taskid,task) in tasks | orderBy : '-time':true | limitTo :25">
        <div ng-if="task.assigned_to == currentUser.uid && task.status != 1"  class="row">

          <a class="col col-90 font14" href="#/menu/tab/tasks/{{taskid}}">
            <p>{{task.name}}</p>

            <div class="row">
              <div class="col col-10" style="margin-top: 2%;">
                <p ng-style="{'background-color': bgColor(task) }" style="height: 10px; width: 10px; border-radius: 50%;"></p>
              </div>
              <div class="col col-60">
                <div class="upperCase">
                  <p>{{status}}</p>
                </div>
              </div>

              <div class="col col-30" ng-if="task.deadline">
                <p><i class="ion-ios-calendar"></i> {{task.deadline | date : 'MMM dd'}}</p>
              </div>
            </div>
          </a>
          <i class="ion-chevron-right font24"></i>
        </div>
      </div>
    </div>

    <div class="showCompletedTasksView_content" ng-show="showCompletedTasksView">
      <!--<div class="item item-tasks item-icon-right"  ng-repeat="(taskid,task) in tasks | orderObjectBy : '-time':true">-->

      <div class="item item-tasks item-icon-right"  ng-repeat="(taskid,task) in tasks | orderBy : 'time':true | limitTo :25">
        <div ng-if="task.assigned_to == currentUser.uid && task.status == 1"  class="row">

          <a class="col col-90 font14" style="margin-top: 2%" href="#/menu/tab/tasks/{{taskid}}">
            <p>{{task.name}}</p>

            <div class="row">
              <div class="col col-10" style="margin-top: 2%;">
                <p ng-style="{'background-color': bgColor(task) }" style="height: 10px; width: 10px; border-radius: 50%;"></p>
              </div>
              <div class="col col-60">
                <div class="upperCase">
                  <p>{{status}}</p>
                </div>
              </div>

              <div class="col col-30" ng-if="task.deadline">
                <p><i class="ion-ios-calendar"></i> {{task.deadline | date : 'MMM dd'}}</p>
              </div>
            </div>
          </a>
          <i class="ion-chevron-right font24"></i>


        </div>

      </div>
    </div>


  </ion-content>

</ion-view>

<script id="my-task.html" type="text/ng-template">
  <ion-modal-view>
    <ion-header-bar>
      <h1 class="title">New task</h1>
    </ion-header-bar>

    <ion-content>
      <h1>{{task.name}}</h1>
      <ul class="list">
        <li class="item">
          Assigned by : {{team.members[task.assigned_by].name}}
        </li>
        <li class="item">
          Assigned to : {{team.members[task.assignee].name}}
        </li>
        <li class="item">
          Due date : {{task.deadline | date : 'MMM dd'}}
        </li>
        <li class="item">
          Status : {{taskStatuses[task.status].name}}
        </li>
      </ul>

      <div class="card">
        <div class="item item-divider">
          Discription
        </div>
        <div class="item item-text-wrap">
          {{task.desc}}
        </div>
      </div>

      <div class="task-archive" ng-if="task.user == myID || task.assignee == myID || task.assigned_to == myID">
        <button type="button" class="button button-block button-balanced" name="button" ng-if="task.status != taskStatusID.ASSIGNED" ng-click="broadcastTask(task)">  post as status  <i class="icon ion-android-share"></i></button>
        <button class="button button-block button-balanced" ng-if="task.status == taskStatusID.ASSIGNED" ng-click="startTask(task)">Start <i class="icon ion-ios-play"></i></button>
        <button class="button button-block button-balanced" ng-if="task.status != taskStatusID.COMPLETE" ng-click="setTaskCompleted(task.key)">complete <i class="icon ion-ios-checkmark-outline"></i></button>
        <button class="button button-block button-balanced" ng-if="activeStreamName != 'archive.all' && activeStreamName != 'archive.to_me'" ng-click="moveToArchive(task.key);">archive <i class="icon ion-ios-trash"></i></button>
        <button class="button button-block button-balanced" ng-if="activeStreamName == 'archive.all' || activeStreamName == 'archive.to_me'" ng-click="moveFromArchive(task.key);">unarchive</button>
      </div>

     <button class="button button-block button-balanced" ng-click="closeModal()">Back</button>

    </ion-content>

  </ion-modal-view>
</script>
